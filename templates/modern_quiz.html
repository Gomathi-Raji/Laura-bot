<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz System - Laura-bot</title>
    
    <!-- Modern Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- UI Framework -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern-ui.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <!-- Real-time -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.4/socket.io.js"></script>
    
    <!-- Chart.js for analytics -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß†</text></svg>">
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-content">
            <a href="/" class="nav-brand">
                <div class="logo">ü§ñ</div>
                Laura-bot
            </a>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="/" class="nav-link">
                        <i class="fas fa-home"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/learn" class="nav-link">
                        <i class="fas fa-graduation-cap"></i> Learn
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/quiz" class="nav-link active">
                        <i class="fas fa-brain"></i> Quiz
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/progress" class="nav-link">
                        <i class="fas fa-chart-line"></i> Progress
                    </a>
                </li>
            </ul>
            
            <div class="nav-actions">
                <div class="quiz-timer" id="quiz-timer">
                    <i class="fas fa-clock"></i>
                    <span id="timer-display">--:--</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <!-- Quiz Selection Screen -->
        <div id="quiz-selection" class="quiz-screen active">
            <section class="hero-section">
                <h1 class="hero-title">Intelligent Quiz System</h1>
                <p class="hero-subtitle">AI-powered adaptive quizzes that adjust to your learning level</p>
            </section>

            <!-- Quiz Categories -->
            <section class="quiz-categories">
                <div class="card-grid">
                    <div class="quiz-category-card modern-card" data-subject="mathematics">
                        <div class="category-header">
                            <div class="category-icon">üìä</div>
                            <div class="category-info">
                                <h3>Mathematics</h3>
                                <p>Algebra, Geometry, Calculus</p>
                            </div>
                        </div>
                        <div class="category-stats">
                            <div class="stat-row">
                                <span>Best Score:</span>
                                <span class="highlight">94%</span>
                            </div>
                            <div class="stat-row">
                                <span>Quizzes Taken:</span>
                                <span class="highlight">12</span>
                            </div>
                            <div class="stat-row">
                                <span>Average Time:</span>
                                <span class="highlight">8m 24s</span>
                            </div>
                        </div>
                        <div class="difficulty-selector">
                            <h4>Select Difficulty:</h4>
                            <div class="difficulty-buttons">
                                <button class="difficulty-btn easy" data-difficulty="easy">Easy</button>
                                <button class="difficulty-btn medium active" data-difficulty="medium">Medium</button>
                                <button class="difficulty-btn hard" data-difficulty="hard">Hard</button>
                            </div>
                        </div>
                        <button class="btn btn-primary start-quiz-btn">Start Mathematics Quiz</button>
                    </div>

                    <div class="quiz-category-card modern-card" data-subject="science">
                        <div class="category-header">
                            <div class="category-icon">üî¨</div>
                            <div class="category-info">
                                <h3>Science</h3>
                                <p>Physics, Chemistry, Biology</p>
                            </div>
                        </div>
                        <div class="category-stats">
                            <div class="stat-row">
                                <span>Best Score:</span>
                                <span class="highlight">87%</span>
                            </div>
                            <div class="stat-row">
                                <span>Quizzes Taken:</span>
                                <span class="highlight">8</span>
                            </div>
                            <div class="stat-row">
                                <span>Average Time:</span>
                                <span class="highlight">12m 15s</span>
                            </div>
                        </div>
                        <div class="difficulty-selector">
                            <h4>Select Difficulty:</h4>
                            <div class="difficulty-buttons">
                                <button class="difficulty-btn easy" data-difficulty="easy">Easy</button>
                                <button class="difficulty-btn medium active" data-difficulty="medium">Medium</button>
                                <button class="difficulty-btn hard" data-difficulty="hard">Hard</button>
                            </div>
                        </div>
                        <button class="btn btn-primary start-quiz-btn">Start Science Quiz</button>
                    </div>

                    <div class="quiz-category-card modern-card" data-subject="history">
                        <div class="category-header">
                            <div class="category-icon">üèõÔ∏è</div>
                            <div class="category-info">
                                <h3>History</h3>
                                <p>World History, Civilizations</p>
                            </div>
                        </div>
                        <div class="category-stats">
                            <div class="stat-row">
                                <span>Best Score:</span>
                                <span class="highlight">92%</span>
                            </div>
                            <div class="stat-row">
                                <span>Quizzes Taken:</span>
                                <span class="highlight">15</span>
                            </div>
                            <div class="stat-row">
                                <span>Average Time:</span>
                                <span class="highlight">6m 48s</span>
                            </div>
                        </div>
                        <div class="difficulty-selector">
                            <h4>Select Difficulty:</h4>
                            <div class="difficulty-buttons">
                                <button class="difficulty-btn easy" data-difficulty="easy">Easy</button>
                                <button class="difficulty-btn medium active" data-difficulty="medium">Medium</button>
                                <button class="difficulty-btn hard" data-difficulty="hard">Hard</button>
                            </div>
                        </div>
                        <button class="btn btn-primary start-quiz-btn">Start History Quiz</button>
                    </div>

                    <div class="quiz-category-card modern-card" data-subject="programming">
                        <div class="category-header">
                            <div class="category-icon">üíª</div>
                            <div class="category-info">
                                <h3>Programming</h3>
                                <p>Python, JavaScript, Algorithms</p>
                            </div>
                        </div>
                        <div class="category-stats">
                            <div class="stat-row">
                                <span>Best Score:</span>
                                <span class="highlight">89%</span>
                            </div>
                            <div class="stat-row">
                                <span>Quizzes Taken:</span>
                                <span class="highlight">6</span>
                            </div>
                            <div class="stat-row">
                                <span>Average Time:</span>
                                <span class="highlight">15m 32s</span>
                            </div>
                        </div>
                        <div class="difficulty-selector">
                            <h4>Select Difficulty:</h4>
                            <div class="difficulty-buttons">
                                <button class="difficulty-btn easy active" data-difficulty="easy">Easy</button>
                                <button class="difficulty-btn medium" data-difficulty="medium">Medium</button>
                                <button class="difficulty-btn hard" data-difficulty="hard">Hard</button>
                            </div>
                        </div>
                        <button class="btn btn-primary start-quiz-btn">Start Programming Quiz</button>
                    </div>
                </div>
            </section>

            <!-- Recent Performance -->
            <section class="glass recent-performance">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i>
                    Recent Performance
                </h2>
                <div class="performance-grid">
                    <div class="performance-chart">
                        <canvas id="performance-chart" width="400" height="200"></canvas>
                    </div>
                    <div class="performance-stats">
                        <div class="perf-stat">
                            <div class="perf-icon">üéØ</div>
                            <div class="perf-info">
                                <div class="perf-value">91%</div>
                                <div class="perf-label">Average Score</div>
                            </div>
                        </div>
                        <div class="perf-stat">
                            <div class="perf-icon">üìà</div>
                            <div class="perf-info">
                                <div class="perf-value">+7%</div>
                                <div class="perf-label">Improvement</div>
                            </div>
                        </div>
                        <div class="perf-stat">
                            <div class="perf-icon">‚ö°</div>
                            <div class="perf-info">
                                <div class="perf-value">9m 12s</div>
                                <div class="perf-label">Avg Time</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Quiz Taking Screen -->
        <div id="quiz-taking" class="quiz-screen">
            <div class="quiz-container">
                <!-- Quiz Header -->
                <div class="quiz-header glass">
                    <div class="quiz-info">
                        <h2 id="quiz-subject">Mathematics Quiz</h2>
                        <div class="quiz-meta">
                            <span class="difficulty-badge" id="quiz-difficulty">Medium</span>
                            <span class="question-counter">
                                Question <span id="current-question">1</span> of <span id="total-questions">10</span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="quiz-progress">
                        <div class="progress-circle">
                            <svg class="progress-ring" width="60" height="60">
                                <circle class="progress-ring-circle" stroke="currentColor" stroke-width="4" fill="transparent" r="26" cx="30" cy="30"/>
                            </svg>
                            <div class="progress-text">10%</div>
                        </div>
                    </div>
                </div>

                <!-- Question Card -->
                <div class="question-card glass">
                    <div class="question-header">
                        <div class="question-type">Multiple Choice</div>
                        <div class="question-points">+5 points</div>
                    </div>
                    
                    <div class="question-content">
                        <h3 id="question-text">What is the solution to the equation x¬≤ - 5x + 6 = 0?</h3>
                        
                        <div class="question-image" id="question-image">
                            <!-- Optional image content -->
                        </div>
                    </div>

                    <div class="answer-options" id="answer-options">
                        <button class="option-btn" data-answer="a">
                            <span class="option-letter">A</span>
                            <span class="option-text">x = 2 and x = 3</span>
                        </button>
                        <button class="option-btn" data-answer="b">
                            <span class="option-letter">B</span>
                            <span class="option-text">x = 1 and x = 6</span>
                        </button>
                        <button class="option-btn" data-answer="c">
                            <span class="option-letter">C</span>
                            <span class="option-text">x = -2 and x = -3</span>
                        </button>
                        <button class="option-btn" data-answer="d">
                            <span class="option-letter">D</span>
                            <span class="option-text">x = 5 and x = 1</span>
                        </button>
                    </div>

                    <div class="question-actions">
                        <button class="btn btn-secondary" id="hint-btn">
                            <i class="fas fa-lightbulb"></i> Hint
                        </button>
                        <button class="btn btn-secondary" id="voice-answer">
                            <i class="fas fa-microphone"></i> Voice Answer
                        </button>
                        <button class="btn btn-primary" id="submit-answer" disabled>
                            Submit Answer
                        </button>
                    </div>

                    <div class="hint-panel" id="hint-panel">
                        <div class="hint-content">
                            <i class="fas fa-lightbulb"></i>
                            <p>Try factoring the quadratic equation. Look for two numbers that multiply to 6 and add to -5.</p>
                        </div>
                    </div>
                </div>

                <!-- AI Assistant Mini Panel -->
                <div class="quiz-assistant glass">
                    <div class="assistant-toggle" id="assistant-toggle">
                        <i class="fas fa-robot"></i>
                        <span>Need Help?</span>
                    </div>
                    <div class="assistant-content" id="assistant-content">
                        <div class="assistant-messages" id="assistant-messages">
                            <div class="assistant-message">
                                I'm here to help! Feel free to ask me about any concept you don't understand.
                            </div>
                        </div>
                        <div class="assistant-input">
                            <input type="text" placeholder="Ask me anything..." class="form-input" id="assistant-input">
                            <button class="btn btn-primary btn-sm" id="send-assistant">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Results Screen -->
        <div id="quiz-results" class="quiz-screen">
            <section class="results-hero">
                <div class="results-icon">üéâ</div>
                <h1 class="results-title">Quiz Complete!</h1>
                <div class="final-score">
                    <div class="score-circle">
                        <svg class="score-ring" width="120" height="120">
                            <circle class="score-ring-bg" stroke="currentColor" stroke-width="8" fill="transparent" r="52" cx="60" cy="60"/>
                            <circle class="score-ring-progress" stroke="currentColor" stroke-width="8" fill="transparent" r="52" cx="60" cy="60"/>
                        </svg>
                        <div class="score-text">
                            <div class="score-percentage" id="final-percentage">87%</div>
                            <div class="score-label">Score</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="results-details glass">
                <div class="results-grid">
                    <div class="result-stat">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-info">
                            <div class="stat-value" id="correct-answers">8</div>
                            <div class="stat-label">Correct</div>
                        </div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-info">
                            <div class="stat-value" id="incorrect-answers">2</div>
                            <div class="stat-label">Incorrect</div>
                        </div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-info">
                            <div class="stat-value" id="time-taken">8m 34s</div>
                            <div class="stat-label">Time</div>
                        </div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-info">
                            <div class="stat-value" id="difficulty-level">Medium</div>
                            <div class="stat-label">Difficulty</div>
                        </div>
                    </div>
                </div>

                <div class="results-actions">
                    <button class="btn btn-secondary" id="review-answers">
                        <i class="fas fa-eye"></i> Review Answers
                    </button>
                    <button class="btn btn-primary" id="take-another">
                        <i class="fas fa-redo"></i> Take Another Quiz
                    </button>
                    <button class="btn btn-secondary" id="view-progress">
                        <i class="fas fa-chart-line"></i> View Progress
                    </button>
                </div>
            </section>

            <section class="improvement-suggestions glass">
                <h3>
                    <i class="fas fa-lightbulb"></i>
                    Suggestions for Improvement
                </h3>
                <div class="suggestions-list" id="suggestions-list">
                    <div class="suggestion-item">
                        <div class="suggestion-icon">üìö</div>
                        <div class="suggestion-content">
                            <div class="suggestion-title">Review Quadratic Equations</div>
                            <div class="suggestion-description">You missed 2 questions on factoring. Consider reviewing the factoring lesson.</div>
                        </div>
                        <button class="btn btn-secondary btn-sm">Review</button>
                    </div>
                    <div class="suggestion-item">
                        <div class="suggestion-icon">‚ö°</div>
                        <div class="suggestion-content">
                            <div class="suggestion-title">Practice Speed</div>
                            <div class="suggestion-description">Your accuracy is great! Try timing yourself to improve speed.</div>
                        </div>
                        <button class="btn btn-secondary btn-sm">Practice</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Enhanced Styles -->
    <style>
        .quiz-screen {
            display: none;
        }
        
        .quiz-screen.active {
            display: block;
        }

        /* Quiz Timer */
        .quiz-timer {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
        }

        /* Quiz Categories */
        .quiz-categories {
            margin: 2rem 0;
        }

        .quiz-category-card {
            padding: 2rem;
            transition: var(--transition-normal);
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .category-icon {
            font-size: 2rem;
        }

        .category-info h3 {
            margin: 0;
            font-family: var(--font-display);
            font-size: 1.5rem;
        }

        .category-info p {
            margin: 0;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .category-stats {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .stat-row:last-child {
            margin-bottom: 0;
        }

        .highlight {
            color: #4facfe;
            font-weight: 600;
        }

        .difficulty-selector h4 {
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .difficulty-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .difficulty-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition-fast);
            font-size: 0.875rem;
        }

        .difficulty-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .difficulty-btn.active {
            background: var(--accent-gradient);
            border-color: transparent;
        }

        .difficulty-btn.easy.active {
            background: linear-gradient(135deg, #4caf50, #81c784);
        }

        .difficulty-btn.hard.active {
            background: linear-gradient(135deg, #f44336, #ef5350);
        }

        .start-quiz-btn {
            width: 100%;
        }

        /* Recent Performance */
        .recent-performance {
            padding: 2rem;
            margin-top: 2rem;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            font-family: var(--font-display);
        }

        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            align-items: center;
        }

        .performance-stats {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .perf-stat {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 12px;
        }

        .perf-icon {
            font-size: 1.5rem;
        }

        .perf-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: #4facfe;
        }

        .perf-label {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Quiz Taking Styles */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
        }

        .quiz-meta {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-top: 0.5rem;
        }

        .question-counter {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .progress-circle {
            position: relative;
            width: 60px;
            height: 60px;
        }

        .progress-ring-circle {
            transition: stroke-dasharray var(--transition-normal);
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.875rem;
            font-weight: 600;
        }

        .question-card {
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-type {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
        }

        .question-points {
            color: #4caf50;
            font-weight: 600;
        }

        .question-content h3 {
            font-size: 1.25rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .option-btn {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            text-align: left;
            cursor: pointer;
            transition: var(--transition-normal);
        }

        .option-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .option-btn.selected {
            background: rgba(79, 172, 254, 0.2);
            border-color: #4facfe;
        }

        .option-btn.correct {
            background: rgba(76, 175, 80, 0.2);
            border-color: #4caf50;
        }

        .option-btn.incorrect {
            background: rgba(244, 67, 54, 0.2);
            border-color: #f44336;
        }

        .option-letter {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
        }

        .question-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hint-panel {
            display: none;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .hint-panel.visible {
            display: block;
        }

        .hint-content {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .hint-content i {
            color: #ffc107;
            margin-top: 0.25rem;
        }

        /* Quiz Assistant */
        .quiz-assistant {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 300px;
            max-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .assistant-toggle {
            padding: 1rem;
            background: var(--accent-gradient);
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .assistant-content {
            display: none;
            flex-direction: column;
            background: var(--glass-bg);
            border-radius: 12px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .assistant-content.visible {
            display: flex;
        }

        .assistant-messages {
            flex: 1;
            padding: 1rem;
            max-height: 200px;
            overflow-y: auto;
        }

        .assistant-message {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
        }

        .assistant-input {
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: 0.5rem;
        }

        .assistant-input .form-input {
            flex: 1;
            font-size: 0.875rem;
        }

        /* Results Styles */
        .results-hero {
            text-align: center;
            margin-bottom: 3rem;
        }

        .results-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .results-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            margin-bottom: 2rem;
        }

        .final-score {
            display: flex;
            justify-content: center;
        }

        .score-circle {
            position: relative;
            width: 120px;
            height: 120px;
        }

        .score-ring-bg {
            stroke: rgba(255, 255, 255, 0.2);
        }

        .score-ring-progress {
            stroke: #4facfe;
            stroke-dasharray: 0 326.7;
            transition: stroke-dasharray 1s ease-in-out;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .score-percentage {
            font-size: 2rem;
            font-weight: 800;
            color: #4facfe;
        }

        .score-label {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .results-details {
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .result-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }

        .result-stat .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .results-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .improvement-suggestions {
            padding: 2rem;
        }

        .suggestions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 12px;
        }

        .suggestion-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .suggestion-content {
            flex: 1;
        }

        .suggestion-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .suggestion-description {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .performance-grid {
                grid-template-columns: 1fr;
            }
            
            .quiz-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .quiz-assistant {
                position: static;
                margin-top: 2rem;
                width: 100%;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>

    <!-- Enhanced JavaScript -->
    <script>
        // Initialize Socket.IO
        const socket = io();
        
        // Quiz state
        let currentQuiz = {
            subject: '',
            difficulty: '',
            questions: [],
            currentIndex: 0,
            answers: [],
            startTime: null,
            score: 0
        };

        let timerInterval = null;

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('.quiz-screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // Difficulty selection
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const parent = this.closest('.difficulty-buttons');
                parent.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Start quiz
        document.querySelectorAll('.start-quiz-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const card = this.closest('.quiz-category-card');
                const subject = card.dataset.subject;
                const difficulty = card.querySelector('.difficulty-btn.active').dataset.difficulty;
                
                startQuiz(subject, difficulty);
            });
        });

        function startQuiz(subject, difficulty) {
            currentQuiz.subject = subject;
            currentQuiz.difficulty = difficulty;
            currentQuiz.startTime = Date.now();
            currentQuiz.currentIndex = 0;
            currentQuiz.answers = [];
            currentQuiz.score = 0;
            
            // Load sample questions (in real app, fetch from server)
            loadQuestions(subject, difficulty);
            
            showScreen('quiz-taking');
            startTimer();
            displayQuestion();
            
            socket.emit('quiz_started', {
                subject: subject,
                difficulty: difficulty
            });
        }

        function loadQuestions(subject, difficulty) {
            // Sample questions - in real app, fetch from server
            const sampleQuestions = {
                mathematics: [
                    {
                        type: 'multiple-choice',
                        question: 'What is the solution to x¬≤ - 5x + 6 = 0?',
                        options: [
                            'x = 2 and x = 3',
                            'x = 1 and x = 6', 
                            'x = -2 and x = -3',
                            'x = 5 and x = 1'
                        ],
                        correct: 0,
                        points: 5,
                        hint: 'Try factoring the quadratic equation. Look for two numbers that multiply to 6 and add to -5.'
                    },
                    // Add more questions...
                ]
            };
            
            currentQuiz.questions = sampleQuestions[subject] || [];
        }

        function displayQuestion() {
            const question = currentQuiz.questions[currentQuiz.currentIndex];
            if (!question) return;
            
            document.getElementById('current-question').textContent = currentQuiz.currentIndex + 1;
            document.getElementById('total-questions').textContent = currentQuiz.questions.length;
            document.getElementById('question-text').textContent = question.question;
            
            const optionsContainer = document.getElementById('answer-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.dataset.answer = index;
                btn.innerHTML = `
                    <span class="option-letter">${String.fromCharCode(65 + index)}</span>
                    <span class="option-text">${option}</span>
                `;
                
                btn.addEventListener('click', function() {
                    selectAnswer(index);
                });
                
                optionsContainer.appendChild(btn);
            });
            
            updateProgress();
            resetHint();
        }

        function selectAnswer(answerIndex) {
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.querySelector(`[data-answer="${answerIndex}"]`).classList.add('selected');
            document.getElementById('submit-answer').disabled = false;
        }

        function submitAnswer() {
            const selectedBtn = document.querySelector('.option-btn.selected');
            if (!selectedBtn) return;
            
            const answerIndex = parseInt(selectedBtn.dataset.answer);
            const question = currentQuiz.questions[currentQuiz.currentIndex];
            const isCorrect = answerIndex === question.correct;
            
            // Visual feedback
            document.querySelectorAll('.option-btn').forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.add('correct');
                } else if (index === answerIndex && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (isCorrect) {
                currentQuiz.score += question.points;
            }
            
            currentQuiz.answers.push({
                questionIndex: currentQuiz.currentIndex,
                selectedAnswer: answerIndex,
                correct: isCorrect,
                points: isCorrect ? question.points : 0
            });
            
            setTimeout(() => {
                nextQuestion();
            }, 2000);
        }

        function nextQuestion() {
            currentQuiz.currentIndex++;
            
            if (currentQuiz.currentIndex >= currentQuiz.questions.length) {
                finishQuiz();
            } else {
                displayQuestion();
            }
        }

        function finishQuiz() {
            stopTimer();
            showResults();
            showScreen('quiz-results');
            
            socket.emit('quiz_completed', {
                subject: currentQuiz.subject,
                difficulty: currentQuiz.difficulty,
                score: currentQuiz.score,
                answers: currentQuiz.answers,
                timeSpent: Date.now() - currentQuiz.startTime
            });
        }

        function showResults() {
            const totalQuestions = currentQuiz.questions.length;
            const correctAnswers = currentQuiz.answers.filter(a => a.correct).length;
            const percentage = Math.round((correctAnswers / totalQuestions) * 100);
            const timeSpent = formatTime(Date.now() - currentQuiz.startTime);
            
            document.getElementById('final-percentage').textContent = percentage + '%';
            document.getElementById('correct-answers').textContent = correctAnswers;
            document.getElementById('incorrect-answers').textContent = totalQuestions - correctAnswers;
            document.getElementById('time-taken').textContent = timeSpent;
            document.getElementById('difficulty-level').textContent = currentQuiz.difficulty.charAt(0).toUpperCase() + currentQuiz.difficulty.slice(1);
            
            // Animate score circle
            const circumference = 2 * Math.PI * 52;
            const progress = (percentage / 100) * circumference;
            document.querySelector('.score-ring-progress').style.strokeDasharray = `${progress} ${circumference}`;
        }

        function updateProgress() {
            const progress = ((currentQuiz.currentIndex + 1) / currentQuiz.questions.length) * 100;
            document.querySelector('.progress-text').textContent = Math.round(progress) + '%';
            
            const circumference = 2 * Math.PI * 26;
            const progressValue = (progress / 100) * circumference;
            document.querySelector('.progress-ring-circle').style.strokeDasharray = `${progressValue} ${circumference}`;
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - currentQuiz.startTime;
                document.getElementById('timer-display').textContent = formatTime(elapsed);
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function formatTime(ms) {
            const seconds = Math.floor(ms / 1000);
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function resetHint() {
            document.getElementById('hint-panel').classList.remove('visible');
        }

        // Event listeners
        document.getElementById('submit-answer').addEventListener('click', submitAnswer);

        document.getElementById('hint-btn').addEventListener('click', function() {
            document.getElementById('hint-panel').classList.toggle('visible');
        });

        document.getElementById('take-another').addEventListener('click', function() {
            showScreen('quiz-selection');
        });

        document.getElementById('view-progress').addEventListener('click', function() {
            window.location.href = '/progress';
        });

        // Assistant toggle
        document.getElementById('assistant-toggle').addEventListener('click', function() {
            document.getElementById('assistant-content').classList.toggle('visible');
        });

        // Initialize performance chart
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('performance-chart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                        datasets: [{
                            label: 'Quiz Scores',
                            data: [75, 82, 88, 91],
                            borderColor: '#4facfe',
                            backgroundColor: 'rgba(79, 172, 254, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.8)'
                                }
                            },
                            y: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.8)'
                                }
                            }
                        }
                    }
                });
            }
        });

        // Socket events
        socket.on('quiz_question', function(data) {
            // Handle dynamic question loading
        });

        socket.on('quiz_feedback', function(data) {
            // Handle AI feedback
        });
    </script>
</body>
</html>